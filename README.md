<p align="center">
  <img alt="SimpleVK logo" title="SimpleVK это PHP библиотека быстрой разработки ботов для VK.COM" src="http://images.vfl.ru/ii/1563283715/1c6a23fb/27226348.png"/>
</p>

# Документация по vk_api
![](https://img.shields.io/packagist/php-v/digitalstars/vk_api.svg?color=FF6F61)
![](https://img.shields.io/badge/VK_API-%3E=%205.101-8992bb.svg)
![](https://img.shields.io/github/release/digitalstars/vk_api.svg?color=green)
![](https://img.shields.io/github/commit-activity/m/digitalstars/vk_api.svg)
[![](https://img.shields.io/packagist/dt/digitalstars/vk_api.svg)](https://packagist.org/packages/digitalstars/vk_api/)
[![](https://img.shields.io/badge/Чат_vk-Вступить-blue.svg)](https://vk.me/join/AJQ1dzQRUQxtfd7zSm4STOmt)

Библиотека упрощает работу с api vk.com  
Чат разработчиков ботов и техническая поддержка по данной библиотеке в этой беседе:  
https://vk.me/join/AJQ1dzQRUQxtfd7zSm4STOmt
> ВНИМАНИЕ!
>* Поддержка бесед работает только если выбрана версия callBack api старше 5.8
>* Библитека адаптирована для версии 5.101
>* Некоторые параметры методов записаны в подобном виде: ($buttons = [], $one_time = False) значения означают параметры по умолчанию, а это значит, что данные параметры не обязательно указывать, если вам не нужно изменить их значения по умолчанию
## Оглавление
* [Подключение](#Подключение)
* [Описание классов и их методов](#Доступные-классы)
    * Класс [vk_api](#Класс-vk_api)
    * Класс [LongPoll](#Класс-LongPoll)
    * Класс [Execute](#Класс-Execute)
    * Класс [Coin](#Класс-Coin)
    * Класс [Group](#Класс-Group)
    * Класс [Auth](#Класс-Auth)
    * Класс [Post](#Класс-Post)
    * Класс [Message](#Класс-Message)
    * Класс [VkApiException](#Исключения-VkApiException)
* [Работа с клавиатурой](#Работа-с-клавиатурой)
* [Работа с placeholders(тегами)](#Работа-с-placeholders)
* [Файл конфигурации](#Файл-конфигурации)
* [Примеры работы](#Примеры-работы)
* [План развития проекта](#План-развития-проекта)
* [Помощь проекту](#Помощь-проекту)
***********************
## Подключение
### Используя composer
```
composer require digitalstars/vk_api
```
```php
require_once "vendor/autoload.php"; //Подключаем библиотеку
```
### Вручную
1. Скачать последний релиз
2. Подключить перемещённый autoload.php
* Подключение autoload.php, если ваш скрипт находится в той же папке, что и папка vk_api-master
```php
require_once "vk_api-master/autoload.php"; //Подключаем библиотеку
```
### Подключение всех классов
```php
use DigitalStar\vk_api\vk_api; // Основной класс
use DigitalStar\vk_api\Coin; // работа с vkcoins
use DigitalStar\vk_api\LongPoll; //работа с longpoll
use DigitalStar\vk_api\Execute; // Поддержка Execute
use DigitalStar\vk_api\Group; // Работа с группами с ключем пользователя
use DigitalStar\vk_api\Auth; // Авторизация
use DigitalStar\vk_api\Post; // Конструктор постов
use DigitalStar\vk_api\Message; // Конструктор сообщений
use DigitalStar\vk_api\VkApiException; // Обработка ошибок
```

## Доступные классы
### Класс vk_api
#### Инициализация класса
* `$vk = vk_api::create('токен группы или пользователя', 'версия api');` авторизация через токен группы/пользователя
* `$vk = vk_api::create('логин', 'пароль', 'версия api');` авторизация через логин/пароль пользователя
* `$vk = vk_api::create('экземпляр класса Auth', 'версия api');` использование уже готовой [авторизации](#Класс-Auth)
#### Методы класса
* `reply($message, $params = [])` - отправка сообщения тому, от кого пришел callback(личка пользователя или беседа)
	* `$params` - массив доп параметров для метода messages.send. Прим: ['attachment' => 'wall_-123_123']
	
* `sendMessage($id, $message, $params = [])` - отправка сообщения
	* `$params` - массив доп параметров для метода messages.send. Прим: ['attachment' => 'wall_-123_123']
	
* [sendButton](#Работа-с-клавиатурой)`($user_id, $message, $buttons = [], $one_time = False, , $params = [])` - отправка клавиатуры _(только если отправитель - группа)_
    * `$user_id` - id пользователя, которому нужно отправить клавиатуру
    * `$message` - сообщение, прикреплённое к клавиатуре(обязательный параметр)
    * `$buttons` - массив клавиатуры
    * `$one_time` - исчезнет ли клавиатура после того, как пользователь ей воспользуется?
    * `$params` - массив доп параметров для метода messages.send. Прим: ['attachment' => 'wall_-123_123']
    
* `forward($id, $id_messages, $params = [])` - пересылает один или несколько сообщений
    * `$id` - id пользователя или беседы
    * `$id_messages` - может принимать либо id сообщения, либо массив с несколькими id сообщений
    * `$params` - массив доп параметров для метода messages.send. Прим: ['attachment' => 'wall_-123_123']
    
* `generateKeyboard($buttons, one_time = false)` - метод для генерации клавиатуры. Используется для создания клавиатуры для sendAllDialogs, или для других методов, где нужно передать уже собранную клавиатуру в messages.send

* `dateRegistration($id)` - возвращает дату регистрации пользователя в формате 12:01:02 08.08.2008

* `forward()` - 
    
* `groupInfo($group_url)` - Возвращает информацию о группе
    * `$group_url` - ссылка на группу в любом виде или id группы
    
* `userInfo($user_url = null, $scope = [])` - Возвращает информацию о пользователе
    * `$user_url` - ссылка на пользователя в любом виде или его id
    * `$scope` - дополнительные параметры запроса к api, в формате: \['параметр' => 'значение',...]
    
* `request($method, $params = [])` - универсальная функция для работы с любыми методами api vk
    * `$method` - метод
    * `$params` - параметры в формате: \['параметр' => 'значение',...]
    
* `sendImage($id, $local_file_path, $params = [])` - отправка изображения
    * `$id` - id того, кому отправится сообщение
    * `$local_file_path` - путь до изображения
    * `$params` - массив доп параметров для метода messages.send. Прим: ['attachment' => 'wall_-123_123']
    
* `uploadDocsGroup($groupID, $local_file_path, $title = null)` - загрузка документа в документы сообщества
    * `$groupID` - id сообщества
    * `$local_file_path` - путь до файла
    * `$title` - название файла (если не указать, то останется локальное название)
    
* `uploadDocsUser($local_file_path, $title = null)` - загрузка документа в документы пользователя _(только с ключем пользователя)_
    * `$local_file_path` - путь до файла
    * `$title` - название файла (если не указать, то останется локальное название)
    
* `sendDocMessage($id, $local_file_path, $title = null, $params = [])` - отправка документа
    * `$id` - id получателя
    * `$local_file_path` - путь до файла
    * `$title` - название файла (если не указать, то останется локальное название)
    * `$params` - массив доп параметров для метода messages.send (нельзя использовать attachment). Прим: ['message' => 'Привет!']
    
* `sendVoice($id, $local_file_path, $params = [])` - отправляет аудиофайл с расширениями |.mp3|.ogg|.pcm|.wav| как голосовое сообщение 
    * `$id` - id получателя
    * `$local_file_path` - путь до файла
    * `$params` - массив доп параметров для метода messages.send (нельзя использовать attachment). Прим: ['message' => 'Привет!']
    
* `getGroupsUser($id = [], $extended = 1, $props = [])` - возвращает информацию о группах пользователя _(только с ключём пользователя)_
    * `$id` - id пользователя, информацию о группах которого надо получить(если не указать, вернёт информацию о пользователе, чей токен)
    * `$extended` - (1 - подробно, 0 - нет)
    * `$props` - дополнительные параметры запроса к api, в формате: \['параметр' => 'значение',...]
    
* `setConfirm($str)` - устанавливает строку подтверждения сервера. Подтверждает автоматически
    * `$str` - строка, которую должен вернуть сервер для подтверждения
    
* `debug()` - включает режим вывода ошибок
    
* `initVars($id, $message, $payload, $user_id, $type, $data)` - инициализирует переменные
> Вы можете назвать переменные по другому, но важно сохранить их порядок. Так же вы можете только часть переменных, например $id, $message а остальные не указывать. Но вы НЕ можете сделать так initVars($id, $type), нужно указать все переменные стоящие до $type.
> Так же функция возвращает $data(весь json от вк в виде объекта), поэтому можно писать так:
```php
$data = $vk->initVars($id, $message);
$time = $data->object->date;
```
  ```php
  //пример кода  
  $vk = vk_api::create(TOKEN, VERSION)->setConfirm(CONFIRM_STR);  
  $vk->initVars($id, $message, $payload, $user_id, $type, $data);
  $vk->reply($message); //отвечает пользователю или в беседу
  ```
  
* `sendWallComment($owner_id, $post_id, $message)` - отправляет комментарий под постом
    * `$owner_id` - id пользователя
    * `$post_id` - id поста
    * `$message` - сообщение
    
* `getAlias($id, $n = null);` - возвращает обращение к пользователю или группе в виде строки по типу @id123 или @public123
    * `$id` - id пользователя или группы, так же можно указать короткий адрес
    * `$n` - принимает 3 параметра или можно не указывать
        * `если не указать` - вернет обращение в виде id
        * `true` - вернет Имя и Фамилию пользователя или название группы. Пример: @id1(Павел Дуров)
        * `false` - вернет только Имя пользователя или название группы Пример: @id1(Павел)
        * `любая кастомная строка, например Котик` - Пример: @id1(Котик)
        
* `sendAllDialogs($message, $keyboard = null, $filter = 'all', $params = [])` - Отправляет сообщение во все диалоги в группе или личной странице(зависит от способа авторизации)
    * `$message` - отправляемый текст
    * `$keyboard` - сгенерированная клавиатура методом generateKeyboard(). Пример кода ниже
    * `$filter` - фильтр диалогов, может принимать такие параметры:
        * `all` — все беседы
        * `unread` — беседы с непрочитанными сообщениями;
        * `important` — беседы, помеченные как важные(только для сообществ); 
        * `unanswered` — беседы, помеченные как неотвеченные(только для сообществ); 
    * `$params` - массив доп параметров для метода messages.send. Прим: ['attachment' => 'wall_-123_123']
    ```php
    $keyboard = $vk->generateKeyboard([[$location],[$pay]], true);
    $vk->sendAllDialogs($message, $keyboard); `
    ```
    
* `sendAllChats($message, $params = [])` - Отправляет сообщение в чаты пользователя или в чаты, куда пригласили бота группы
    * `$params` - массив доп параметров для метода messages.send. Прим: ['attachment' => 'wall_-123_123']
    
* `isAdmin($id, $chat_id)` - проверяет, является ли $id админов в беседе $chat_id. Если пользователя ,нет в беседе или нет админ прав, то вылетит exception, советую сделать try catch для этой команды
    * `$id` - id пользователя
    * `$chat_id` - id чата
    
    Может вернуть следущие значения:
    * `owner` - создатель
    * `admin` - админ
    * `false` - пользователь
    * `null` - пользователя нет в беседе
    
* `setTryCountResendFile($var)` - задаёт максимальное количество попыток загрузки файла
    * У vk, бывает, с этим возникают некоторые баги и файл не загружается
    * `$var` - число попыток, по умолчанию 5, также можно настроить число по умолчанию в [файле конфигурации](#Файл-конфигурации)
    
* `setRequestIgnoreError($var)` - задаёт коды ошибок vk, при которых сообщение об ошибке игнорируется и отправляется повторный запрос
    * Внимание! запрос будет отправляться бесконечно, пока не получит от api vk ответ об успешном выполнении!
    * `$var` - массив кодов ошибок, по умолчанию [6,9,14], также можно настроить число по умолчанию в [файле конфигурации](#Файл-конфигурации)
    
******************
### Класс LongPoll
Класс позволяет работать LongPoll
#### Подключение
```php
require_once('vendor/autoload.php'); //подключаем библу
use DigitalStar\vk_api\vk_api;
use DigitalStar\vk_api\LongPoll;
```
#### Получения событий в группе
```php
$vk = vk_api::create(TOKEN, '5.95');
$vk = new LongPoll($vk);

$vk->listen(function($data)use($vk){ //в $data содержится все данные события, можно убрать, если не нужен
    $vk->initVars($id, $message);
    $vk->reply($message);
});
```
#### Получение событий пользователя
```php
$vk = vk_api::create('login', 'password', '5.95');
$vk = new LongPoll($vk);

$vk->listen(function()use($vk){ //longpoll для пользователя
    $vk->on('new_message', function($data)use($vk) {
        $vk->initVars($id, $message);
        $vk->reply($message);
    });
});
```
#### Методы класса
Все методы [vk_api](#Класс-vk_api)
******************
### Класс Execute
#### Подключение
```php
require_once('vendor/autoload.php'); //подключаем библу
use DigitalStar\vk_api\vk_api;
use DigitalStar\vk_api\Execute;
```
#### Инициализация класса
`$vk = new Execute($vk);`
> При использовании вместе с LongPoll следует передать этот объект при инициализации LongPoll
#### Поддерживаемые методы
* `reply($message, $params = [])` - отправка сообщения тому, от кого пришел callback(личка пользователя или беседа)
* `sendMessage($id, $message, $params = [])` - отправка сообщения
* [sendButton](#Работа-с-клавиатурой)`($user_id, $message, $buttons = [], $one_time = False)` - отправка клавиатуры
* Полная поддержка конструктора сообщений, если инициализировать конструктор от данного экземпляра
> Также будут работать все методы класса vk_api, но в обычном режиме, а не в режиме Execute
#### Специальные методы
* `exec()` - выполняет все накопленные методы (максимум 25)
> При использовании Execute, запросы к api vk накапливаются в памяти, как только количество запросов достигнет 25,
они отправятся одним запросом на api vk, так же запросы отправляются при вызове деструктора экземпляра Execute
(при завершении скрипта или функции, где он был инициализирован). Также можно запросить отправку вручную (если запросов < 25), с помощью метода
exec()

> При использовании LongPoll вместе с Execute, метод exec() вызывается автоматически после обработки каждой 'пачки'
полученных данных

> При испоьзовании Callback exec() вызывается автоматически при завершении скрипта

#### Примеры использования
* [Простой бот на LongPool](https://github.com/digitalstars/vk_api/blob/master/Examples/simple_longpoll_execute_group.php)
* [Простой бот на CallBack](https://github.com/digitalstars/vk_api/blob/master/Examples/simple_callback_execute.php)
*****************
### Класс Coin
#### Подключение
```php
require_once('vendor/autoload.php'); //подключаем библу
use DigitalStar\vk_api\vk_api;
use DigitalStar\vk_api\Coin;
```
#### Инициализация класса
* `$coin = new Coin(COIN_API_KEY, COIN_API_ID);`
* или
* `$сoin = Coin::create(COIN_API_KEY, COIN_API_ID);`
    * `COIN_API_KEY` - Ключ вашего магазина
    * `COIN_API_ID` - идентификатор владельца магазина.
#### Методы класса
* `sendCoins($user_id, $amount)` - отправка платежа.
>ВНИМАНИЕ, 1 единица = 1 coin. Если вы хотите отправить меньше одного коина, то пишите 0.001
* `getBalance($user_ids = [])` - получение баланса. Можно передать id или массив id. Если не задан `$user_ids`, вернет баланс магазина.
* `setName($name)` - установка имени магазина.
* `setCallBack($url = null)` - Установка callBack-сервера для примема платежей через специальную ссылку.
* `deleteCallBack()` -  удаление callBack-сервера.
* `getLogs()` - получение списка ошибок и изменений в настройках callBack.
* `verifyKeys($data)` - Сверка ключей callBack. Вернет true или false
* `getLink($sum = 0, $fixed_sum = true, $payload = 0, $to_hex = false)` - Получение платежной ссылки.
    * `$sum` - сумма
    * `$fixed_sum` - Не дает возмоджности изменить сумму. Принимает true/false
    * `$payload` - полезная нагрузка для ссылки. Принимает int значение
    * `$to_hex` - кодирует в hex вид ссылку. Сделана скорее для скрытия данных от школьников. Если true - может не работать проверка ключей.
    > Вернет массив ['url' => ..., 'payload' => ...]. Для получения ссылки пишите getLink(...)['url']
    
* `getStoryShop($last_tx)` - получить 100 последних транзакций на аккаунт
    * `$last_tx` - id транзакции, после которой будут браться 100 следующих транзакций
    
* `getStoryAccount($last_tx)` - получить 1000 последних транзакций по генерированных ссылкам функцией getLink
    * `$last_tx` - id транзакции, после которой будут браться 1000 следующих транзакций
    
* `getInfoTransactions($id_transactions)` - получить информацию о транзакциях. Принимает 1 id или массив id
* `initVars($from_id, $amount, $payload, $verify, $data)` - инициализирует переменные, которые есть в callback транзакции
    * `$data` - здесь находится все данные калбэка. На случай, если вам нужны переменные которые не задаются в функции
    * `$verify` - содержит true или false. Защита, если кто-то вдруг найдет путь до вашего callback скрипта
    
#### Примеры использования
* [Настройка магазина](https://github.com/digitalstars/vk_api/blob/master/Examples/setting_coin.php)
* [Прием платежей](https://github.com/digitalstars/vk_api/blob/master/Examples/coin_callback.php)
 ******************
### Класс Group

Класс позволяет работать с группами от имени пользователя (используя токен доступа пользователя)
#### Инициализация класса
* `$my_group = new group('id группы', 'экземпляр класса vk_api')`
#### Методы класса
Все методы [vk_api](#Класс-vk_api), которые можно использовать с ключём доступа сообщества
*******************
### Класс Auth
Класс нужен для кастомной авторизации в vk, можно задать множество параметров при авторизации и выбрать метод авторизации, также получить токен доступа или куки
#### Инициализация класса
* `$my_auth = new Auth('логин', 'пароль', $other = null, $mobile = true)` - авторизация через логин и пароль
    * Это инициализация по умолчанию при авторизации через логин/пароль в [vk_api](#Класс-vk_api)
    * $mobile - выбор метода авторизации (true - будет использоваться штатная авторизация под видом мобильного приложения, false - авторизация через приложение vk)
    
* `$my_auth = new Auth('куки', null, $other = null)` - авторизация через куки
    * куки - массив в json с куками
    * Работает только если куки были получены на том же сервере (с тем же ip), с которого происходит авторизация
    * Рекомендуется использовать куки, полученный при вызове метода dumpCookie()
    * Авторизацию через куки можно использовать, только если куки были получены при авторизации через приложение VK!
    
```
$other - массив для изменения значений по умолчанию
может принимать значения: ['useragent' => 'пользовательский User-Agent', 'id_app' => 'id приложения для авторизации через приложение vk'] 
Причём как что-то одно, так и все сразу
Значения по умолчанию useragent и id_app можно также изменить в файле конфигурации
```
> Как показала практика, авторизация через приложение vk может по непонятным причинам забагаваться для аккаунта, решение пока не найдено, и непонятно что на это влияет.

> Штатная авторизация под видом мобильного приложения самая надёжная и работает всегда. Рекомендуется использовать именно её
#### Методы класса
* `auth()` - запускает процесс авторизации _(ТОЛЬКО ДЛЯ АВТОРИЗАЦИИ ЧЕРЕЗ ПРИЛОЖЕНИЕ vk)_
    * После вызова метода происходит авторизация в vk (получение авторизационнах кук), но не получение токена доступа.
    (Смысл авторизации под видом мобильного приложения заключается в получении токена доступа, по этому метод auth() бессмысленен
    для метода авторизации через мобильное приложение)
    
* `dumpCookie()` - возвращает текущие куки в формате JSON
* `isAuth()` - проверяет, выполнена ли авторизация _вернёт true или false_
* `getAccessToken($captcha_key = null, $captcha_sid = null)` - попытаться получить токен доступа, при успехе его и вернёт
    * Параметры не работают при авторизации через приложение VK
    * `$captcha_key` - решение каптчи
    * `$captcha_sid` - сид каптчи, полученный при ошибки ([VkApiException](#Исключения-VkApiException), можно поймать через try catch вместе со ссылкой на картинку каптчи) если при предыдущей попытке авторизации вылетала каптча
    
**************
### Класс Post
Этот класс является удобным конструктором запросов для создания и публикации постов
#### Инициализация класса
* `$new_post = new Post('экземпляр класса vk_api')`
#### Методы класса
* `setMessage($message)` - задаёт текст
* `addImage($images1, $images2,...)` - добавляет картинки во вложения
    * Может принимать как 1 параметр (массив из ссылок на файлы), так и 1 или больше отдельных параметров (строк - ссылок на файлы)
    
* `addProp($prop, $value)` - задаёт дополнительный(пользовательский) параметр в запросе к api
    * `$prop` - название параметра
    * `$value` - значение
    
* `addDocs($docs, $title = null)` - добавляет документы во вложения
    * Может работать двумя способами:
        * Принимать `$docs` - путь до файла и `$title` - новое название файла, если нужно изменить
        * Принимать массив: `[['path' => 'путь', 'title' => 'название'], ['path' => 'путь', 'title' => null],...]`
	
* `removeImages($images)` - удаляет из вложений картинку с путём `$images`
* `removeDocs($docs)` - удаляет из вложений документ с путём `$docs`
* `removeProp($prop)` - удаляет пользовательский параметр `$prop`
* `getMedia()` - возвращает весь массив вложений
* `getMessage()` - возвращает заданное сообщение
* `getProps()` - возвращает пользовательские параметры
* `send($id, $publish_date = null)` - публикует пост, возвращает id поста после публикации
    * `$id` - id пользователя или сообщества (если сообщества, то с минусом), на стену которого будет опубликован пост
    * `$publish_date` - дата в формате Unixtime, когда будет опубликована запись (опубликуется в отложенные до этого времени).
    Если не задать, опубликуетс сразу же
> Максимальное количество вложений - 10. Это ограничение самого VK, при превышении сгенерируется исключение

> Также метод send() можно вызывать сколько угодно раз с разными параметрами, для публикации одного и того же поста в разных местах

> При вызове нескольких методов подряд с префиксом add или remove, они будут дополнять друг друга, а не заменять
******************
### Класс Message
Этот класс является удобным конструктором запросов для создания и отпраvkи сообщений
#### Инициализация класса
* `$new_message = new Message($vk)`
    * `$vk` - экземпляр класса vk_api или group, при инициализации в группе с ключем пользователя
    
#### Методы класса
Все те же, что и у класса [Post](#Класс-Post), только `send()` слегка другой и есть дополнительные
* [setKeyboard](#Работа-с-клавиатурой)`($keyboard = [], $one_time = false)` - прикрепляет клавиатуру к сообщению _(только если отпровитель - бот)_
    * `$buttons` - массив клавиатуры
    * `$one_time` - исчезнет ли клавиатура после того, как пользователь ей воспользуется?
    * В целом, работает так же, как и `sendButton()`
    
* `getKeyboard()` - возвращает настройки прикреплённой клавиатуры
* `addVoice($local_file_path)` - прикрепляет голосовое сообщение
    * `$local_file_path` - путь до медиафайла. Поддерживаемые форматы: |.mp3|.ogg|.pcm|.wav|
    
* `send($id)` - отправляет сообщение
    * `$id` - $id адресата сообщения
    
****************
## Исключения VkApiException
```php
try {

} catch (VkApiException $e) {
    $e->getMessage() // сообщение ошибки
}
```
> Исключение генерируется, если VK возвращает в ответ ошибку (возвращается весь JSON вывода), и в некоторых случаях библиотека
сама генерирует исключение.
*******************
## Работа с клавиатурой
Все методы находятся в vk_api модуле. 
>ВАЖНО! Если у параметра в методе указано значение по умолчанию, значит этот параметр не обязательный

### Методы
* `buttonText($text, $color, $payload = null)` - Обычная кнопка
	* $color - цвет кнопки, может принимать 4 значения: white, blue, green, red  
	* $payload - полезная нагрузка кнопки, которая возвращается на сервер при нажатии. может принимать null или ассоциативный Юмассив(причем даже с несколькими значениями, например можно даже запихивать кнопки в кнопки)

* `buttonApp($text, $app_id, $owner_id = null, $hash = null, $payload = null)` - кнопка открытия vk apps приложения
	* $app_id - id приложения  
	* $owner_id - id группы. Нужен в том случае, когда приложение нужно запустить от лица группы, например VkCoin или PixelBattle  
	* $hash - хэш для навигации в приложении, будет передан в url приложения после символа #. Можно открывать сразу нужные страниицы  
	* $payload - идентичен как и в первом методе

* `buttonLocation($payload = null)` - кнопка отправки текущего местонахождение. Результат приходит в обычном messages_new
	* $payload - идентичен как и в первом методе

* `buttonPayToGroup($group_id, $amount, $description = null, $data = null, $payload = null)` - оплата товара. Платеж приходит в группу. Данная кнопка занимает всю ширину строки
	* $group_id - id группы, в которую придет платеж. Можно даже чужую. Но в настройках группы должны быть активированы платежи
	* $amount - целове число в рублях. 
	* $description - описание платежа  
	* $data - словарь с произвольными параметрами. Пока еще не понял, зачем он нужен  
	* $payload - идентичен как и в первом методе

* `buttonPayToUser($user_id, $amount, $description = null, $payload = null)` - оплата товара. Платеж приходит пользователю. Данная кнопка занимает всю ширину строки
	* $user_id - id пользователя, которому придет платеж. Возможно нужно иметь vk pay кошелек, чтобы принимать.
	* $amount - целове число в рублях  
	* $description - описание платежа  
	* $payload - идентичен как и в первом методе

* `buttonDonateToGroup($group_id, $payload = null)` - нефиксированный перевод группе. Думаю применяется для донатов или покупки внутриигровой валюты в необходимом количестве. Данная кнопка занимает всю ширину строки
	* $group_id - id группы, в которую придет платеж. Можно даже чужую. Но в настройках группы должны быть активированы платежи  
	* $payload - идентичен как и в первом методе

* `buttonDonateToUser($user_id, $payload = null)` - нефиксированный перевод пользователю. Думаю применяется для донатов или покупки внутриигровой валюты в необходимом количестве. Данная кнопка занимает всю ширину строки
	* $user_id - id пользователя, которому придет платеж. Возможно нужно иметь vk pay кошелек, чтобы принимать   
	* $payload - идентичен как и в первом методе

### Пример создания и отправки кнопок:
Кнопки - это массив с массивами. Если во внутреннем массиве 1 переменная, значит она занимает всю строку. Если N - то они делят строку на равные части, но не более 4 в одной строке.
```php
$vk = vk_api::create(VK_KEY, '5.101');
$location = $vk->buttonLocation();
$app = $vk->buttonApp('Играть', 6840293);
$pay_user = $vk->buttonPayToUser(89846036, 100, 'Оплата покупки',['command' => 'pay']);
$text1 = $vk->buttonText('Negative', 'red', ['color' => 'red']);
$text2 = $vk->buttonText('Positive', 'green', ['color' => 'green']);
$text3 = $vk->buttonText('Primary', 'blue', ['olololo' => 'ebobo?', 'color' => 'green']);
$text4 = $vk->buttonText('Secondary', 'white');

$vk->sendButton(89846036, 'Лови кнопки', [[$location],[$app],[$pay_user],[$text1, $text2, $text3, $text4]]);
```
Данный пример выведет такие кнопки  
![example](https://pp.userapi.com/c853516/v853516515/65ca5/JJBGWKXGsAk.jpg)
### Удаление кнопок (клавиатуры из диалога):
Обращаем ваше внимание, что если передать параметр $one_time = True (см. отправка клавиатуры), клавиатура исчезнет после нажатия на одну из кнопок.\
Для того, что-бы вручную выключить клавиатуру, нужно выполнить следующий запрос:
```php
$id // ID пользователя
$message // Сообщение, отправляемое при удалении клавиатуры
$vk->sendButton($id, $message);
```
*******************
## Работа с placeholders
Для методов reply, sendMessage, sendButton доступна работа с placeholders. Этот функционал пришел на замену getAlias, который теперь преимущественно используется для создания кастомных упоминаний, или генерации ссылок для использования в других методах

#### Расшифровка
Буквы в тегах расшифровываются так:
* `f` - first
* `l` - last
* `n` - name
* `full` - полное имя
* `a` - это отзначает, что тег будет в виде упоминания через @
Это сделано для быстрого написания тегов, зная эти слова

#### Доступные теги
* `%fn%` - имя
* `%ln%` - фамилия
* `%full%` - имя фамилия
* `%a_fn%` - имя в виде упоминания
* `%a_ln%` - фамилия в виде упоминания
* `%a_full%` - имя фамилия в виде упоминания

#### Пример
```php
$vk->reply('Привет `%a_fn%`');
```

#### Производительность
Если вы волнуетесь за скорость отправки сообщений без тегов, потому что теперь там лишние проверки и блалала. Скажу так, там только 1 проверка с поиском по строке %, которая занимает < 0.001с(если у вас конечно не текст на 4к символов), так что на производительность не влияет.
********************
## Файл конфигурации
Файл конфигурации называется `config.php` и находится в папке vk_api\
Пользовательские параметры файла:
```php
    // массив кодов ошибок vk, при которых сообщение об ошибке игнорируется и отправляется повторный запрос к api
const REQUEST_IGNORE_ERROR = [6,9,14];
    // максимальное количество попыток загрузки файла
const COUNT_TRY_SEND_FILE = 5;

    // Auth
    // Запрашиваемые права доступа для токена пользователя по уполчанию
const DEFAULT_SCOPE = "notify,friends,photos,audio,video,stories,pages,status,notes,messages,wall,ads,offline,docs,groups,notifications,stats,email,market";
    // User-Agent по умолчанию
const DEFAULT_USERAGENT = 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36';
    // ID приложения vk по умолчанию
const DEFAULT_ID_APP = '6660888';    
```
*******************************
## Примеры работы
Файлы с некоторыми примерами работы библиотеки лежат в Examples
> При установке через composer пути менять не нужно, примеры в Examples уже подключены и будут работать

## План развития проекта
В процессе заполнения

## Помощь проекту
- Яндекс.Деньги - <money.yandex.ru/to/410014638432302>
- Дебетовая карта - 2202201272652211
- Также вы можете помочь проекту `Pull Request`'ом
